(()=>{"use strict";function e(){this.status="",this.messageContent="",this.setStatus=e=>this.status=e,this.setMessage=e=>this.messageContent=`<div class="close"><i class="message_btn_close btn bx bx-x" ></i></div><div class="message">${e}</div>`,this.getMessage=()=>this.message,this.getMessageElement=()=>{let e=document.createElement("div");return e.setAttribute("class",`modal_message ${this.status}`),e.innerHTML=this.messageContent,e}}function t(e){let t=document.querySelector(".notification_block");t&&t.classList.toggle("hide"),setTimeout((()=>{t&&t.remove()}),setTimeout)}function s(){let e=document.querySelector(".post_categories_params"),t={};if(e){let s=e.querySelectorAll("input");Object.keys(s).forEach((e=>{let o=s[e].closest(".category");if(o){let e=o.querySelector("input"),s=e.name;t[s]={},t[s].category_id=e.dataset.categoryId,t[s].is_category_checked=e.checked,t[s].subcategories=[]}})),t&&Object.keys(t).forEach((s=>{let o=e.querySelector(`input[name="${s}"]`),r=e.querySelector(`ul.${s}`);if(r){let e=r.querySelectorAll("input");Object.keys(e).forEach((o=>{let r=e[o];r.checked&&t[s].subcategories.push(r.dataset.subcategoryId)}))}t[s].subcategories.length||o.checked||delete t[s]}))}return t}document.addEventListener("click",(e=>{if(e.target.classList.contains("message_btn_close")){let t=e.target.closest(".modal_message");t.classList.toggle("hide"),setTimeout((()=>{t.remove()}),400)}}));let o={required:function(e){return"object"==typeof e?Object.keys(e).length:Boolean(e)},minLength:function(e,t){return e.length>=t},maxLength:function(e,t){return e.length<=t},isEmail:function(e){let t=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return Boolean(e.match(t))},isPasswordRepeated:function(e,t){return e===t}};function r(s,o){t(),setTimeout((()=>{let t=s.querySelectorAll(".error_field");t&&Object.keys(t).forEach((e=>{t[e].classList.toggle("error_field")}));let r=Object.keys(o),n=document.createElement("div");n.setAttribute("class","notification_block"),document.body.appendChild(n),r.forEach((t=>{let r,i=new e,a=s.querySelector(`input[name="${t}"]`),l=s.querySelector(`textarea[name="${t}"]`);a&&s.querySelector(`input[name="${t}"]`).classList.toggle("error_field"),l&&s.querySelector(`textarea[name="${t}"]`).classList.toggle("error_field"),r=o[t][0].message?o[t][0].message:o[t][0],i.setMessage(r),i.setStatus("error"),n.appendChild(i.getMessageElement())}))}),500)}let n={username:["required",{minLength:2},{maxLength:50}],password:["required"]},i={username:{required:"Enter your login.",minLength:"Your login is too short. Minimum length is 2.",maxLength:"Your login is too long. Maximum length is 50."},password:{required:"Enter your password.",minLength:"Your password is too short. Minimum length is 8.",maxLength:"Your password is too long. Maximum length is 50."}},a=document.querySelector(".log_in_form");a.addEventListener("submit",(function(l){l.preventDefault();let c=function(e,t,n){let i=function(e,t){let o=e.querySelectorAll("input"),r=e.querySelectorAll("textarea"),n=document.querySelector(".post_create_form"),i={};return o&&o.forEach((e=>{let s=e.name;t.includes(s)&&("gender"==s?e.checked&&(i[s]=e.value):i[s]=e.value)})),r&&r.forEach((e=>{if(e.closest(".django-ckeditor-widget")){let t=CKEDITOR.instances[`id_${e.name}`],s=t.getData();if(i[e.name]=s,s.length){let e=200,s=t.document.getBody().getText().trim().slice(0,e),o=t.document.findOne("img");i.preview_image_url=o?o.getAttribute("src"):"",i.preview_text=s}}else i[e.name]=e.value})),n&&Object.assign(i,{post_subcategory:s()}),i}(e,Object.keys(t)),a=function(e,t,s){let r=Object.keys(e),n={};return r.forEach((r=>{t[r].forEach((t=>{let i="object"==typeof t,a=i?Object.keys(t)[0]:t,l=i?o[a]:o[t],c=!0;if(i)"maxLength"!=a&&"minLength"!=a||(c=l(e[r],t[a]));else if("isPasswordRepeated"==a){let t=e.password;t&&(c=l(t,e[r]))}else c=l(e[r]);if(!c){let e=s[r][a];n[r]||(n[r]=[]),e||console.log(`There is no error message for validator '${a}' for '${r}' field`),n[r].push(e)}}))})),n}(i,t,n),l=!Object.keys(a).length,c={isValid:l,formData:""};return l?c.formData=i:r(e,a),c}(a,n,i);if(c.isValid){let s=c.formData,o=window.location.origin;!function(s,o,n,i=null){let a=(c="csrftoken",function(){let e=document.cookie,t={};return e&&""!==e&&(t=e.split(";").map((e=>e.split("="))).reduce(((e,t)=>{let s=t[0].trim(),o=t[1];return e[s]={},e[s]=o,e}),t)),t}()[c]),l={};var c;l=fetch(`${n}/`,{method:"POST",credentials:"same-origin",headers:{Accept:"application/json","X-Requested_with":"XMLHttpRequest","X-CSRFToken":a},body:JSON.stringify(o)}).then((e=>e.json())).then((o=>{if("success"==o.status){if(t(),o.success_message){let t=document.createElement("div"),s=new e;s.setStatus(o.status),s.setMessage(o.success_message),t.setAttribute("class","notification_block"),t.appendChild(s.getMessageElement()),document.body.appendChild(t)}i&&setTimeout((()=>{window.location=i}),500),o.redirect_url&&setTimeout((()=>{window.location=o.redirect_url}),500)}return"error"==o.status&&(console.log(o.errors),console.log(JSON.parse(o.errors)),r(s,JSON.parse(o.errors))),o})).catch((e=>{console.log(e)}))}(a,s,"validate_login_form",o)}}),!1),a.setAttribute("novalidate","novalidate"),a.querySelector('input[name="username"]').setAttribute("placeholder","Login"),a.querySelector('input[name="username"]').setAttribute("autocomplete","off"),a.querySelector('input[name="password"]').setAttribute("placeholder","Password")})();